(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8767fe62"],{"17c2":function(t,a,s){"use strict";var e=s("b727").forEach,i=s("a640"),n=s("ae40"),r=i("forEach"),c=n("forEach");t.exports=r&&c?[].forEach:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}},"1f22":function(t,a,s){t.exports=s.p+"img/smallfoot3.9e17af49.png"},4160:function(t,a,s){"use strict";var e=s("23e7"),i=s("17c2");e({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"4a4b":function(t,a,s){"use strict";var e=s("c734"),i=s.n(e);i.a},6264:function(t,a,s){"use strict";var e=function(){var t=this,a=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"foot"},[e("div",{staticClass:"center"},[e("div",{staticClass:"information"},[e("div",{staticClass:"logo"},[e("img",{attrs:{src:s("93d1"),alt:""}})]),e("div",{staticClass:"link"},[e("span",[t._v("© 2020.05.05 京ICP备000号 京公网安备00000号 京ICP证000号 违法和不良信息举报电话: "),e("span",{staticStyle:{color:"#4b61c1"}},[t._v("010-87560895 ")]),t._v("举报邮箱: "),e("span",{staticStyle:{color:"#4b61c1"}},[t._v("hello@163.com")])]),e("span",[t._v("部分图片源自网络，版权归原作者所有，如有侵权，请告知将立即删除！")]),e("div",{staticClass:"pic"},[e("img",{attrs:{src:s("dd5c"),alt:""}}),e("img",{attrs:{src:s("b925"),alt:""}}),e("img",{attrs:{src:s("1f22"),alt:""}})])])])])])}],n={name:"smallFoot"},r=n,c=(s("79d2"),s("2877")),o=Object(c["a"])(r,e,i,!1,null,"2be0af6e",null);a["a"]=o.exports},"65f0":function(t,a,s){var e=s("861d"),i=s("e8b5"),n=s("b622"),r=n("species");t.exports=function(t,a){var s;return i(t)&&(s=t.constructor,"function"!=typeof s||s!==Array&&!i(s.prototype)?e(s)&&(s=s[r],null===s&&(s=void 0)):s=void 0),new(void 0===s?Array:s)(0===a?0:a)}},7607:function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"writeStrategy"},[s("div",{staticClass:"topPart"},[t.imageUrl?s("div",{staticClass:"page-background"},[s("img",{attrs:{src:t.imageUrl}}),s("span",{staticClass:"delete",on:{click:function(a){t.imageUrl=""}}},[t._v("X")])]):s("div",{staticClass:"uploadBox"},[s("div",{staticClass:"upload",on:{click:function(a){return t.triggerUpload("1")}}},[s("a-icon",{staticClass:"icon",attrs:{type:"plus"}}),s("br"),s("span",[t._v("选择图片")]),s("input",{ref:"bgUpload",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.handleChange}})],1),t._m(0)]),s("div",{staticClass:"center"},[s("a-input",{staticClass:"titleInput",attrs:{size:"large",placeholder:"填写游记标题"},model:{value:t.title,callback:function(a){t.title=a},expression:"title"}}),t._m(1)],1)]),s("div",{staticClass:"center"},[s("ul",{staticClass:"messageBox"},[s("li",{staticClass:"item"},[s("span",{staticClass:"iconfont icon-stragegyDetail-time"}),s("span",[t._v("出发时间")]),s("span",{staticClass:"interval"},[t._v("：")]),s("a-date-picker",{staticClass:"dataPicker",attrs:{placeholder:"选择日期"},on:{change:t.onChange}})],1),s("li",{staticClass:"item"},[s("span",{staticClass:"iconfont icon-stragegyDetail-days"}),s("span",[t._v("出行天数")]),s("span",{staticClass:"interval"},[t._v("：")]),s("a-input",{staticClass:"money",attrs:{placeholder:"天数"},model:{value:t.day,callback:function(a){t.day=a},expression:"day"}}),s("span",[t._v("天")])],1),s("li",{staticClass:"item"},[s("span",{staticClass:"iconfont icon-location"}),s("span",[t._v("地点")]),s("span",{staticClass:"interval"},[t._v("：")]),s("a-input",{staticClass:"money",attrs:{placeholder:"地址"},model:{value:t.address,callback:function(a){t.address=a},expression:"address"}})],1),s("li",{staticClass:"item"},[s("span",{staticClass:"iconfont icon-stragegyDetail-people"}),s("span",[t._v("人物")]),s("span",{staticClass:"interval"},[t._v("：")]),s("a-input",{staticClass:"money",attrs:{placeholder:"旅行的人"},model:{value:t.person,callback:function(a){t.person=a},expression:"person"}})],1),s("li",{staticClass:"item"},[s("span",{staticClass:"iconfont icon-stragegyDetail-price"}),s("span",[t._v("人均费用")]),s("span",{staticClass:"interval"},[t._v("：")]),s("a-input",{staticClass:"money",attrs:{placeholder:"费用"},model:{value:t.cost,callback:function(a){t.cost=a},expression:"cost"}}),s("span",[t._v("RMB")])],1)]),t._l(t.message,(function(a,e){return s("div",{key:e,staticClass:"article"},[s("h3",[t._v(t._s(a.itemTitle))]),s("p",[t._v(t._s(a.itemContent))]),s("div",[s("img",{attrs:{src:a.picture}})])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isAddPar,expression:"isAddPar"}],staticClass:"paragraph"},[s("h3",[t._v("段落 "+t._s(t.message.length+1))]),s("a-input",{staticClass:"title",attrs:{placeholder:"请输入标题"},model:{value:t.itemTitle,callback:function(a){t.itemTitle=a},expression:"itemTitle"}}),s("a-textarea",{attrs:{placeholder:"请输入内容",rows:10},model:{value:t.itemContent,callback:function(a){t.itemContent=a},expression:"itemContent"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.paragraphPicUrl,expression:"paragraphPicUrl"}],staticClass:"pic_list"},[s("img",{attrs:{src:t.paragraphPicUrl}}),s("span",{staticClass:"delete",on:{click:function(a){t.paragraphPicUrl=""}}},[t._v("X")])]),s("div",{staticClass:"btns"},[s("span",{directives:[{name:"show",rawName:"v-show",value:""==t.paragraphPicUrl,expression:"paragraphPicUrl==''"}],staticClass:"uploadImg",on:{click:function(a){return t.triggerUpload("2")}}},[t._v("添加图片")]),s("input",{ref:"avatarInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.handleUploadImg}}),s("span",{staticClass:"save",on:{click:t.savePar}},[t._v("保存")])])],1)],2),s("div",{staticClass:"btnBox"},[s("span",{staticClass:"addPar",on:{click:t.addPar}},[t._v("添加段落")]),s("span",{staticClass:"btn",on:{click:t.publishArticle}},[t._v("发表游记")])]),s("smallFoot")],1)},i=[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"describe"},[s("h1",[t._v("设置游记头图")]),s("p",[t._v("图片建议选择尺寸大于1680px的高清大图，如相机原图")])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("span",{staticClass:"tips"},[t._v("可输入"),s("span",{staticClass:"num"},[t._v("40")]),t._v("个字")])}],n=(s("4160"),s("b0c0"),s("6264")),r={name:"writeStrategy",components:{smallFoot:n["a"]},data:function(){return{account:"",token:"",imageUrl:"",title:"",day:"",person:"",cost:"",address:"",dataString:"",message:[],isAddPar:!0,itemTitle:"",itemContent:"",paragraphPicUrl:"",paragraphPic:"",pictureData:[]}},methods:{handleChange:function(){var t=this.$refs.bgUpload.files,a=this;function s(t){var s=new FileReader;s.onload=function(){a.imageUrl=this.result},s.readAsDataURL(t)}t&&([].forEach.call(t,s),this.pictureData.push(t[0]))},onChange:function(t,a){this.dataString=a},showConfirm:function(t,a){this.$confirm({title:t,okText:"确认",cancelText:"取消",onOk:function(){a()}})},handleUploadImg:function(){var t=this.$refs.avatarInput.files,a=this;function s(t){if(/\.(jpe?g|png|gif)$/i.test(t.name)){var s=new FileReader;s.onload=function(){a.paragraphPicUrl=this.result},s.readAsDataURL(t)}}t&&([].forEach.call(t,s),this.paragraphPic=t[0])},savePar:function(){if(""==this.itemTitle||""==this.itemContent)this.$message.error("请输入内容后在保存");else{var t={};t.itemTitle=this.itemTitle,t.itemContent=this.itemContent,t.picture=this.paragraphPicUrl,t.picflag="0",this.paragraphPicUrl&&(this.pictureData.push(this.paragraphPic),t.picflag="1"),this.message.push(t),this.isAddPar=!1,this.paragraphPicUrl=this.itemTitle=this.itemContent=""}},triggerUpload:function(t){1==t?this.$refs.bgUpload.dispatchEvent(new MouseEvent("click")):this.$refs.avatarInput.dispatchEvent(new MouseEvent("click"))},addPar:function(){this.isAddPar?this.savePar():this.message.length>=5?(this.isAddPar=!1,this.$message.warning("长度受限，不能继续添加")):this.isAddPar=!0},publishArticle:function(){var t=this;""==this.day||""==this.person||""==this.cost||""==this.address||""==this.dataString?this.$message.warning("请填写完整信息框的内容"):""==this.title?this.$message.warning("请填写标题"):this.isAddPar?this.$message.warning("请保存段落内容后再发表"):""==this.imageUrl?this.$message.warning("请设置背景图"):this.showConfirm("是否确认发表？",(function(){for(var a=new FormData,s=0;s<t.pictureData.length;s++)a.append("file",t.pictureData[s]);a.append("token",t.token),a.append("nickName",t.$store.state.nickName),a.append("user_id",t.account),a.append("headPic",t.$store.state.headPic),a.append("mainTitle",t.title),a.append("address",t.address),a.append("cost",t.cost),a.append("travel_time",t.dataString),a.append("person",t.person),a.append("duration",t.day);for(var e=1;e<=5;e++){var i="title"+e,n="cont"+e,r="pic"+e;e>t.message.length?(a.append(i,""),a.append(n,""),a.append(r,"0")):(a.append(i,t.message[e-1].itemTitle),a.append(n,t.message[e-1].itemContent),a.append(r,t.message[e-1].picflag))}t.$https.post("/strategy/add",a).then((function(a){if(a.body.success){var s=t;t.$message.success(a.body.rspDesc),setTimeout((function(){s.$router.push({path:"/person",query:{navIndex:2}})}),500),t.paragraphPic=t.imageUrl="",t.pictureData=[]}else t.$message.error(a.body.rspDesc)}))}))}},created:function(){this.$store.commit("setNavigation",-1),this.account=this.$store.state.account,this.token=this.$store.state.token}},c=r,o=(s("4a4b"),s("2877")),l=Object(o["a"])(c,e,i,!1,null,null,null);a["default"]=l.exports},"79d2":function(t,a,s){"use strict";var e=s("d75e"),i=s.n(e);i.a},a640:function(t,a,s){"use strict";var e=s("d039");t.exports=function(t,a){var s=[][t];return!!s&&e((function(){s.call(null,a||function(){throw 1},1)}))}},b0c0:function(t,a,s){var e=s("83ab"),i=s("9bf2").f,n=Function.prototype,r=n.toString,c=/^\s*function ([^ (]*)/,o="name";!e||o in n||i(n,o,{configurable:!0,get:function(){try{return r.call(this).match(c)[1]}catch(t){return""}}})},b727:function(t,a,s){var e=s("0366"),i=s("44ad"),n=s("7b0b"),r=s("50c4"),c=s("65f0"),o=[].push,l=function(t){var a=1==t,s=2==t,l=3==t,p=4==t,d=6==t,u=5==t||d;return function(h,f,v,m){for(var g,C,_=n(h),b=i(_),y=e(f,v,3),P=r(b.length),k=0,w=m||c,x=a?w(h,P):s?w(h,0):void 0;P>k;k++)if((u||k in b)&&(g=b[k],C=y(g,k,_),t))if(a)x[k]=C;else if(C)switch(t){case 3:return!0;case 5:return g;case 6:return k;case 2:o.call(x,g)}else if(p)return!1;return d?-1:l||p?p:x}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6)}},b925:function(t,a,s){t.exports=s.p+"img/smallfoot2.debc706e.png"},c734:function(t,a,s){},d75e:function(t,a,s){},dd5c:function(t,a,s){t.exports=s.p+"img/smallfoot1.87ff788f.png"}}]);
//# sourceMappingURL=chunk-8767fe62.47abda46.js.map